<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Otawa: Parametric Features and Processor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Otawa
   &#160;<span id="projectnumber">0.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__parametric.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Parametric Features and Processor</div>  </div>
</div><!--header-->
<div class="contents">

<p>Usual features and associated processors are defined for computing exactly one feature.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1ActualFeature.html">otawa::ActualFeature</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An actual feature is the result of the instantiation of a parametric feature.  <a href="classotawa_1_1ActualFeature.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1ParamFeature.html">otawa::ParamFeature</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A parametric feature is a feature that may be instantiated according to some parameters passed in a property list.  <a href="classotawa_1_1ParamFeature.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1AbstractParamIdentifier.html">otawa::AbstractParamIdentifier</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A parametric identifier allows to instantiate identifier depending on a parametric feature.  <a href="classotawa_1_1AbstractParamIdentifier.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1ParamIdentifier.html">otawa::ParamIdentifier&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of <a class="el" href="classotawa_1_1AbstractParamIdentifier.html">AbstractParamIdentifier</a> for an <a class="el" href="classotawa_1_1Identifier.html">Identifier</a>.  <a href="classotawa_1_1ParamIdentifier.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1AbstractParamProcessor.html">otawa::AbstractParamProcessor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abstract form of a parametric processor.  <a href="classotawa_1_1AbstractParamProcessor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1ParamProcessor.html">otawa::ParamProcessor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A parametric processor allows to generate processor for parametric feature.  <a href="classotawa_1_1ParamProcessor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Usual features and associated processors are defined for computing exactly one feature. </p>
<p>Yet, several features in the WCET computation may have the same behaviour but with different configurations. For example, in several microprocessors, we may have several levels of cache (L1, L2, ...) exhibiting the same behaviour but with different configurations.</p>
<h1><a class="anchor" id="parametric_declare"></a>
Declaring and requiring</h1>
<p>Parametric and processors allows to use the same feature/processors system for different facilities in a WCET computation. Basically, a parametric feature is a feature generator. The feature are identified by specific parameters passed to the parametric feature. For the example of a cache, the parameter may be the description of the cache. Once the parameter is passed, the actual feature may be generated by the parametric feature. The code belows continue with the example of the cache and show the declaration of the parametric feature in a header file. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Cache_8h.html">otawa/hard/Cache.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ParamFeature_8h.html">otawa/proc/ParamFeature.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">extern</span> Identifier&lt;hard::Cache *&gt; CACHE;</div><div class="line"><span class="keyword">extern</span> ParamFeature CACHE_SUPPORT;</div></div><!-- fragment --><p>A processor that has to require the feature with a given cache has to obtain the actual feature from the paramtric feature and to require it: </p><div class="fragment"><div class="line">UserProcessor::UserProcessor(hard::Cache *<a class="code" href="oipet_8cpp.html#ac6e5af6ae98f5722af58320dee88d683">cache</a>) {</div><div class="line">     PropList params;</div><div class="line">     CACHE(params) = <a class="code" href="oipet_8cpp.html#ac6e5af6ae98f5722af58320dee88d683">cache</a>;</div><div class="line">     ActualFeature *cache_feature = CACHE_SUPPORT.get(params);</div><div class="line">     <a class="code" href="namespaceotawa_1_1p.html#acdf1a6b40bcb4de283ee07d716cd2cf7">require</a>(cache_feature);</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="parametric_using"></a>
Using the parametric feature</h1>
<p>Getting an actual feature is not enough to use it. Indeed, each actual feature has its own set of identifier to use to hook annotation on the program representation. When a parametric feature is instantiated into an actual feature, it also instantiates a set of parametric identifiers. The instantiated identifiers are then hooked to be used by the requirer processor.</p>
<p>The code below show how to declare parametric identifiers: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Cache_8h.html">otawa/hard/Cache.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ParamFeature_8h.html">otawa/proc/ParamFeature.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">extern</span> Identifier&lt;hard::Cache *&gt; CACHE;</div><div class="line"><span class="keyword">extern</span> ParamFeature CACHE_SUPPORT;</div><div class="line"><span class="keyword">extern</span> ParamIdentifier&lt;category_t&gt; <a class="code" href="namespaceotawa.html#acd82978b6c58864f2d761536914eb38f">CATEGORY</a>;</div></div><!-- fragment --><p>The requirer processor then may use the instantiated identifier to retrieve annotation put on the program representation: </p><div class="fragment"><div class="line"><span class="keyword">class </span>UserProcessor: <span class="keyword">public</span> BBprocessor {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">               UserProcessor::UserProcessor(hard::Cache *cache) {</div><div class="line">               PropList params;</div><div class="line">               CACHE(params) = <a class="code" href="oipet_8cpp.html#ac6e5af6ae98f5722af58320dee88d683">cache</a>;</div><div class="line">               ActualFeature *cache_feature = CACHE_SUPPORT.get(params);</div><div class="line">               <a class="code" href="namespaceotawa_1_1p.html#acdf1a6b40bcb4de283ee07d716cd2cf7">require</a>(cache_feature);</div><div class="line">               CAT = &amp;CATEGORY.instantiate(cache_feature);</div><div class="line">       }</div><div class="line">    <span class="keyword">protected</span>:</div><div class="line">       <span class="keywordtype">void</span> processBB(WorkSpace *ws, CFG *cfg, <a class="code" href="namespaceBasicBlock.html">BasicBlock</a> *bb) {</div><div class="line">               <a class="code" href="namespaceotawa.html#a4a7d491cf8be1115243016341459de6c">category_t</a> *cat = (*CAT)[<a class="code" href="namespaceotawa_1_1cfgio.html#a8fbd4403568f9f360cf0625d6aee5fe6">bb</a>];</div><div class="line">               ...</div><div class="line">       }</div><div class="line">    <span class="keyword">private</span>:</div><div class="line">       Identifier&lt;category_t&gt; *CAT;</div><div class="line">};</div></div><!-- fragment --><h1><a class="anchor" id="parametric_implementing"></a>
Implementing the parametric processor</h1>
<p>A parametric processor is processor implementing a parametric feature. Usually, a default parametric processor is passed as parameter to a default feature and used to generate a processor customized with an actual feature.</p>
<p>From the example below, we get below the source file of the parametric feature and its parametric processor: </p><div class="fragment"><div class="line"><span class="keyword">class </span>CacheProcessor {</div><div class="line">};</div><div class="line"></div><div class="line">ParamProcessor CACHE_PROCESSOR(<span class="stringliteral">&quot;CACHE_PROCESSOR&quot;</span>, Version(1, 0, 0), <span class="keyword">new</span> ParamProcessor::Maker&lt;CacheProcessor&gt;());</div><div class="line"></div><div class="line">Identifier&lt;hard::Cache *&gt; CACHE(<span class="stringliteral">&quot;CACHE&quot;</span>);</div><div class="line">ParamFeature CACHE_SUPPORT(<span class="stringliteral">&quot;CACHE_SUPPORT&quot;</span>, CACHE_PROCESSOR);</div><div class="line">ParamIdentifier&lt;category_t&gt; <a class="code" href="namespaceotawa.html#acd82978b6c58864f2d761536914eb38f">CATEGORY</a>(CACHE_SUPPORT, <span class="stringliteral">&quot;CATEGORY&quot;</span>);</div></div><!-- fragment --><p>In this example, the default processor implementation is given by the CacheProcessor class. This cache must have a constructor taking as parameter the name, the version and the actual feature. This actual feature is used by the processor to get instantiation parameters and instantiated parametric identified associated with the feature. The code below continues the example: </p><div class="fragment"><div class="line"><span class="keyword">class </span>CacheProcessor: <span class="keyword">public</span> BBProcessor {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">     CacheProcessor(cstring <a class="code" href="odisasm_8cpp.html#a99b5b93c8719819cd32df8ea44de6d70">name</a>, Version version, AcutalFeature *feature)</div><div class="line">        : BBProcessor(name, version), cache(CACHE(feature)), CAT(CATEGORY(feature))</div><div class="line">        { }</div><div class="line"></div><div class="line">     <span class="keyword">protected</span>:</div><div class="line">        <span class="keywordtype">void</span> processBB(WorkSpace *ws, CFG *cfg, <a class="code" href="namespaceBasicBlock.html">BasicBlock</a> *bb) {</div><div class="line">                CAT(bb) = computeCategory(bb);</div><div class="line">        }</div><div class="line"></div><div class="line">     <span class="keyword">private</span>:</div><div class="line">        hard::Cache *<a class="code" href="oipet_8cpp.html#ac6e5af6ae98f5722af58320dee88d683">cache</a>;</div><div class="line">        Identifier&lt;category_t&gt;&amp; CAT;</div><div class="line">};</div></div><!-- fragment --><p>In fact, the actual features contains two sets of annotations: </p><ul>
<li>parameters of the parametric feature instantiation (identifier passed to instantiations) (CACHE in our example) </li>
<li>identifier from the parametric identifier instantiation (hooked with parametric identifiers) (CAT in our example) </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
