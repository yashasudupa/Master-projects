<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Otawa: Program Representation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Otawa
   &#160;<span id="projectnumber">0.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__prog.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Program Representation</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1Inst.html">otawa::Inst</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents assembly instruction of a piece of code.  <a href="classotawa_1_1Inst.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1Manager.html">otawa::Manager</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The manager class providesfacilities for storing, grouping and retrieving shared resources like loaders and platforms.  <a href="classotawa_1_1Manager.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1Process.html">otawa::Process</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A process is the realization of a program on a platform.  <a href="classotawa_1_1Process.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1File.html">otawa::File</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents a file involved in the building of a process.  <a href="classotawa_1_1File.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1ProgItem.html">otawa::ProgItem</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class of the components of a program file segment.  <a href="classotawa_1_1ProgItem.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1Segment.html">otawa::Segment</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">In usual file format like ELF, COFF and so on, the program file is divided in segment according platform needs or memory propertes.  <a href="classotawa_1_1Segment.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1Symbol.html">otawa::Symbol</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A symbol is a name of a location in a program.  <a href="classotawa_1_1Symbol.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classotawa_1_1WorkSpace.html">otawa::WorkSpace</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A workspace represents a program, its run-time and all information about WCET computation or any other analysis.  <a href="classotawa_1_1WorkSpace.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div align="center">
<img src="dot_inline_dotgraph_1.png" alt="dot_inline_dotgraph_1.png" border="0" usemap="#dot_inline_dotgraph_1.map"/>
<map name="dot_inline_dotgraph_1.map" id="dot_inline_dotgraph_1.map"><area shape="rect" id="node1" href="classotawa_1_1Manager.html" title="{Manager||}" alt="" coords="12,5,84,83"/>
<area shape="rect" id="node2" href="classotawa_1_1WorkSpace.html" title="{WorkSpace||}" alt="" coords="5,143,91,220"/>
<area shape="rect" id="node3" href="classotawa_1_1Process.html" title="{Process||}" alt="" coords="12,280,84,357"/>
<area shape="rect" id="node4" href="classotawa_1_1File.html" title="{File||}" alt="" coords="97,417,169,495"/>
<area shape="rect" id="node5" href="classotawa_1_1Segment.html" title="{Segment||}" alt="" coords="119,280,191,357"/>
<area shape="rect" id="node6" href="classotawa_1_1ProgItem.html" title="{ProgItem||}" alt="" coords="119,143,191,220"/>
<area shape="rect" id="node7" href="classotawa_1_1Symbol.html" title="{Symbol||}" alt="" coords="215,280,287,357"/>
<area shape="rect" id="node8" href="classotawa_1_1Inst.html" title="{Inst||}" alt="" coords="119,5,191,83"/>
</map>
</div>
<h1><a class="anchor" id="prog_desc"></a>
Description</h1>
<p>The program representation module of OTAWA is the main module providing all details about the processed program. It provides a representation built from the program binary form (Process) and provides a workspace to perform analyses (WorkSpace). Usually, a workspace containing a process is provided by the manager (<a class="el" href="classotawa_1_1Manager.html">otawa::Manager</a>) as a simple <a class="el" href="namespaceotawa_1_1sem.html#a6844edc409329a16f8aa2199baad2ff4">Manager::load()</a> call: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="otawa_8h.html">otawa/otawa.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceelm.html">elm</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceotawa.html">otawa</a>;</div><div class="line"></div><div class="line"><span class="keywordflow">try</span> {</div><div class="line">  <a class="code" href="classotawa_1_1PropList.html">PropList</a> props;</div><div class="line">  <a class="code" href="namespaceotawa.html#aa5b443176fc2102eac788f2724c80536">Processor::VERBOSE</a>(props) = <span class="keyword">true</span>;</div><div class="line">  <a class="code" href="classotawa_1_1WorkSpace.html">WorkSpace</a> *ws = <a class="code" href="namespaceotawa.html#a946e4877f280f89353488f41c1262649">MANAGER</a>.<a class="code" href="classotawa_1_1Manager.html#af07cc03d2114a4392a627e61f1e80e8e">load</a>(<span class="stringliteral">&quot;path_to_file&quot;</span>, props);</div><div class="line">  ...</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"><span class="keywordflow">catch</span>(<a class="code" href="classotawa_1_1Exception.html">otawa::Exception</a>&amp; e) {</div><div class="line">  cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: &quot;</span> &lt;&lt; e.message() &lt;&lt; io::endl;</div><div class="line">  <span class="keywordflow">return</span> 1;</div><div class="line">}</div></div><!-- fragment --><p> The load may possibly fail and throw an <a class="el" href="classotawa_1_1Exception.html">otawa::Exception</a> exception.</p>
<p>The Process class describes the full program and its execution environment as different items of description: </p><ul>
<li>the <a class="el" href="classotawa_1_1File.html">otawa::File</a> represents a binary file involved in the building of the execution environments (each program has at least one file containing the main program and possibly other file for dynamically linked libraries &ndash; most often zero in embedded systems), </li>
<li>the <a class="el" href="classotawa_1_1Segment.html">otawa::Segment</a> divides the program in different parts (code, data, etc), </li>
<li>the <a class="el" href="classotawa_1_1ProgItem.html">otawa::ProgItem</a> decompose each segment into code or data items, </li>
<li>the <a class="el" href="classotawa_1_1Inst.html">otawa::Inst</a> is an instance of <a class="el" href="classotawa_1_1ProgItem.html">otawa::ProgItem</a> that represents a single instruction, </li>
<li>the otawa::DataItem is an instance of <a class="el" href="classotawa_1_1ProgItem.html">otawa::ProgItem</a> that represents a piece of data, </li>
<li>the <a class="el" href="classotawa_1_1Symbol.html">otawa::Symbol</a> represents a named reference on some ProgItem</li>
</ul>
<p>To load a program, the following properties may be useful: </p><ul>
<li><a class="el" href="namespaceotawa.html#a10691625126e96a7d827b89d56e91a8b">otawa::TASK_ENTRY</a> &ndash; name of the function used as entry point. </li>
<li><a class="el" href="namespaceotawa.html#a41822736a6b7110f112ae583f864df2b">otawa::LOADER_NAME</a> &ndash; name of loader to use. </li>
<li><a class="el" href="namespaceotawa.html#ad4f09b0ad624ce45b0e101cf1fe52ebd">otawa::CACHE_CONFIG</a> &ndash; handle on cache configuration. </li>
<li><a class="el" href="namespaceotawa.html#a1dbb925e2594860f9a41d89c1f2a9674">otawa::CACHE_CONFIG_PATH</a> &ndash; path to cache configuration. </li>
<li><a class="el" href="namespaceotawa.html#a9f506deeb4fa0d6b4ffc3f07740dbbe4">otawa::MEMORY_OBJECT</a> &ndash; handle on memory configuration. </li>
<li><a class="el" href="namespaceotawa.html#ab3246245f82b4a170bb33a0183890961">otawa::MEMORY_PATH</a> &ndash; path to memory configuration. </li>
<li><a class="el" href="namespaceotawa.html#a68d90364d7b7c7fdb86c380e36460a4e">otawa::PROCESSOR</a> &ndash; handle on microprocessor configuration. </li>
<li><a class="el" href="namespaceotawa.html#a7c598f7f44779116c7f1f418ae7b350a">otawa::PROCESSOR_PATH</a> &ndash; path to microprocessor configuration. </li>
<li><a class="el" href="namespaceotawa.html#afa6ee540e1f440ba8e78ca12d2da6d0a">otawa::LOAD_PARAM</a> &ndash; useful to pass a parameter to a loader in the form "ID=VALUE".</li>
</ul>
<p>Expert users can also use the following properties: </p><ul>
<li><a class="el" href="namespaceotawa.html#acdc9a1098311ae959403a5f0dc16a02b">otawa::LOADER</a> &ndash; handle of loader to use. </li>
<li><a class="el" href="namespaceotawa.html#a6692950dc1970703ce5cc65a76794b76">otawa::ARGC</a> &ndash; count of arguments passed to task on the stack. </li>
<li><a class="el" href="namespaceotawa.html#a4812f5dcee244a16e024257316efa604">otawa::ARGV</a> &ndash; null-terminated list of arguments passed to task on the stack. </li>
<li><a class="el" href="namespaceotawa.html#a264d026cad5bea48cb051f976483a448">otawa::ENVP</a> &ndash; null-terminated list of environments to task on the stack. </li>
<li><a class="el" href="namespaceotawa.html#a6353d91c74cd4e5c9fa06ef17d3f9b05">otawa::NO_SYSTEM</a> &ndash; no system is running the task.</li>
</ul>
<p>A commonly used propertu with IPET method is the property below: </p><ul>
<li><a class="el" href="namespaceotawa_1_1ipet.html#a08228d7cfaf66db6eccf70a09b33a568">otawa::ipet::ILP_PLUGIN_NAME</a> &ndash; to select which to use to solve the IPET ILP system.</li>
</ul>
<p>Notice that most properties listed above may be used with <a class="el" href="group__commands.html#owcet">owcet Command</a> command or most OTAWA command using "--add-prop" option. Ask for command description with "-h" option or look at <a class="el" href="classotawa_1_1Application.html">otawa::Application</a> for more details.</p>
<h1><a class="anchor" id="prog_vliw"></a>
VLIW Support</h1>
<p>VLIW (Very Long Instruction Word) is a technology allowing to execute in parallel several instructions, in order, without the logic needed to analyze dependencies between instructions and to re-order instructions as found in out-of-order architectures. Instruction are grouped into bundles that are guaranteed by compiler to be executable in parallel.</p>
<p>For instance, runned on a VLIW computer, the ARM instructions below perform actually an exchange of register R0 and R1 (end of bundle is denoted by double semi-colon): </p><div class="fragment"><div class="line">MOV R0, R1;</div><div class="line">MOV R1, R0;;</div></div><!-- fragment --><p> In fact, when the bundle above is executed, registers R1 and R0 are read in parallel and the assignment to R0, respectively to R1, is also performed in parallel.</p>
<p>OTAWA provides a specific support for VLIW but the bundle-aware resources can be used as is by non-VLIW instruction set: bundles will be composed of only one instruction in this case. Whatever, using bundle-aware architecture allows adaptation for free of analyzes to VLIW and non-VLIW architectures. Following bundle facilities are available: </p><ul>
<li>Inst::isBundleEnd() &ndash; end of bundle detection, </li>
<li>Inst::semInsts(sem::Block&amp;, int temp) &ndash; semantic instruction generation with temporary re-basing, </li>
<li>Inst::semWriteBack() &ndash; parallel write-back generation of registers from temporaries to actual registers, </li>
<li>BasicBlock::BundleIter &ndash; iterator on the bundle composing a basic block.</li>
</ul>
<p>A special attention must be devoted to supporting semantic instruction. Model of execution of semantic instruction is purely sequential. Hence, VLIW instruction set semantic cannot be preserved if semantic instructions of machine are executed sequentially. Re-using the example of register exchange above, the straight translation into semantics will only copy R1 to R0: </p><div class="fragment"><div class="line">MOV R0, R1</div><div class="line">   <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(R0, R1)</div><div class="line">MOV R1, R0</div><div class="line">   <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(R1, R0)</div></div><!-- fragment --><p>A simple trick allows maintaining the current semantic instruction behavior and to adapt without effort existing analysis to VLIW: just copy write-back registers into temporaries and delay write-back to the end of execution of semantic instructions. Therefore, the semantic instructions implementing a machine instructions of a bundle need only to be concatenated and ended by write-back operations. uses these temporaries instead (our example continued): </p><div class="fragment"><div class="line">MOV R0, R1</div><div class="line">        <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(T1, R1)             <span class="comment">// T1 refers to R0</span></div><div class="line">MOV R1, R0                      <span class="comment">// T2 refers to R1</span></div><div class="line">        <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(T2, R0)</div><div class="line"></div><div class="line">        <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(R0, T1)</div><div class="line">        <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(R1, R2)</div></div><!-- fragment --><p>This requires the help of the VLIW instructions to build such a sequence. Usually, the template to translate into semantic instructions looks like: </p><div class="fragment"><div class="line">MOV ri, rj</div><div class="line">   <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(ri, rj)</div></div><!-- fragment --><p>For VLIW, this template must be re-defined to perform write-back on temporaries: </p><div class="fragment"><div class="line">MOV ri, rj</div><div class="line">        semantic</div><div class="line">                <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(temp, rj)</div><div class="line">        write-back (1 temporary used)</div><div class="line">                <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(ri, temp)</div></div><!-- fragment --><p>Write-back sequence is obtained by a call to Inst::semWriteBack() that returns also the number of used temporaries and Inst::semInsts() allows generating the semantic instruction using a specific temporary base. To detail the example, we get: </p><div class="fragment"><div class="line">   Inst(MOV R0, R1).semInsts(block, T1) = 1</div><div class="line">           <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(T1, R1)</div><div class="line">   Inst(MOV R1, R0).semInsts(block, T2) = 1</div><div class="line">           <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(T2, R0)</div><div class="line">Inst(MOV R0, R1).semWriteBack(block, T1) = 1</div><div class="line">   <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(R0, T1)</div><div class="line">Inst(MOV R1, R0).semWriteBack(block, T2) = 1</div><div class="line">   <a class="code" href="namespaceotawa_1_1sem.html#ac29c0b1c9a35b2b57d3978c82402562aa34d2066c3400aed85cd6d808671a6602">SET</a>(R1, T2)</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
